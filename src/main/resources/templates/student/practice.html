<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>코딩연습 - CodeBattleArena</title>
    <link href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/variable/pretendardvariable.min.css" rel="stylesheet">
    <link rel="stylesheet" href="/css/common.css">
    <link rel="stylesheet" href="/css/student.css">
    <style>
        .practice-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .practice-header {
            background: white;
            padding: 30px;
            border-radius: 12px;
            margin-bottom: 30px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.08);
        }
        
        .practice-title {
            font-size: 2.2rem;
            font-weight: 700;
            color: #1a202c;
            margin-bottom: 10px;
        }
        
        .practice-subtitle {
            font-size: 1.1rem;
            color: #718096;
        }
        
        .category-tabs {
            display: flex;
            gap: 8px;
            margin-bottom: 30px;
            overflow-x: auto;
            padding: 8px;
            background: white;
            border-radius: 12px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.08);
        }
        
        .category-tab {
            padding: 12px 24px;
            border: none;
            background: #f7fafc;
            color: #4a5568;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 500;
            white-space: nowrap;
            transition: all 0.2s;
        }
        
        .category-tab.active {
            background: #3182ce;
            color: white;
        }
        
        .category-tab:hover {
            background: #e2e8f0;
        }
        
        .category-tab.active:hover {
            background: #2c5282;
        }
        
        .problems-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(400px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .problem-card {
            background: white;
            border-radius: 12px;
            padding: 24px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.08);
            transition: all 0.3s;
            border: 1px solid #e2e8f0;
        }
        
        .problem-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.12);
        }
        
        .problem-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 16px;
        }
        
        .problem-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: #2d3748;
            margin-bottom: 8px;
        }
        
        .difficulty-badge {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
        }
        
        .difficulty-easy {
            background: #c6f6d5;
            color: #22543d;
        }
        
        .difficulty-medium {
            background: #fed7aa;
            color: #c05621;
        }
        
        .difficulty-hard {
            background: #fed7d7;
            color: #c53030;
        }
        
        .problem-description {
            color: #4a5568;
            line-height: 1.6;
            margin-bottom: 20px;
        }
        
        .problem-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            color: #718096;
            font-size: 0.9rem;
        }
        
        .problem-stats {
            display: flex;
            gap: 16px;
        }
        
        .problem-actions {
            display: flex;
            gap: 12px;
        }
        
        .btn-solve {
            flex: 1;
            padding: 12px 20px;
            background: #3182ce;
            color: white;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: background 0.2s;
        }
        
        .btn-solve:hover {
            background: #2c5282;
        }
        
        .btn-solution {
            padding: 12px 16px;
            background: #f7fafc;
            color: #4a5568;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .btn-solution:hover {
            background: #e2e8f0;
        }
        
        .problem-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            display: none;
            z-index: 1000;
        }
        
        .modal-content {
            width: 95%;
            height: 95%;
            background: white;
            margin: 2.5% auto;
            border-radius: 12px;
            display: flex;
            overflow: hidden;
        }
        
        .problem-section {
            width: 50%;
            padding: 30px;
            overflow-y: auto;
            border-right: 1px solid #e2e8f0;
        }
        
        .code-section {
            width: 50%;
            display: flex;
            flex-direction: column;
        }
        
        .code-header {
            padding: 20px 30px;
            background: #f7fafc;
            border-bottom: 1px solid #e2e8f0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .code-editor {
            flex: 1;
            padding: 20px;
            background: #1a202c;
        }
        
        .code-textarea {
            width: 100%;
            height: 100%;
            background: #2d3748;
            color: #e2e8f0;
            border: none;
            padding: 20px;
            font-family: 'Fira Code', monospace;
            font-size: 14px;
            line-height: 1.6;
            resize: none;
            outline: none;
        }
        
        .code-actions {
            padding: 20px 30px;
            background: #f7fafc;
            border-top: 1px solid #e2e8f0;
            display: flex;
            gap: 12px;
            justify-content: flex-end;
        }
        
        .btn-run {
            padding: 10px 20px;
            background: #38a169;
            color: white;
            border: none;
            border-radius: 6px;
            font-weight: 600;
            cursor: pointer;
        }
        
        .btn-submit {
            padding: 10px 20px;
            background: #3182ce;
            color: white;
            border: none;
            border-radius: 6px;
            font-weight: 600;
            cursor: pointer;
        }
        
        .btn-close {
            position: absolute;
            top: 20px;
            right: 20px;
            width: 40px;
            height: 40px;
            background: #f56565;
            color: white;
            border: none;
            border-radius: 50%;
            cursor: pointer;
            font-size: 18px;
            z-index: 10;
        }
    </style>
</head>
<body>
    <div class="student-layout">
        <div th:replace="~{common/student-sidebar}"></div>
        
        <div class="main-content">
            <div class="practice-container">
                <div class="practice-header">
                    <h1 class="practice-title">코딩연습</h1>
                    <p class="practice-subtitle">다양한 알고리즘 문제로 실력을 향상시키세요</p>
                </div>
                
                <div class="category-tabs">
                    <button class="category-tab active" data-category="all">전체</button>
                    <button class="category-tab" data-category="array">배열</button>
                    <button class="category-tab" data-category="string">문자열</button>
                    <button class="category-tab" data-category="loop">반복문</button>
                    <button class="category-tab" data-category="condition">조건문</button>
                    <button class="category-tab" data-category="function">함수</button>
                    <button class="category-tab" data-category="recursion">재귀</button>
                    <button class="category-tab" data-category="sorting">정렬</button>
                    <button class="category-tab" data-category="search">탐색</button>
                    <button class="category-tab" data-category="graph">그래프</button>
                    <button class="category-tab" data-category="dp">동적계획법</button>
                    <button class="category-tab" data-category="greedy">그리디</button>
                </div>
                
                <div class="problems-grid" id="problemsGrid">
                    <!-- 문제들이 여기에 동적으로 로드됩니다 -->
                </div>
            </div>
        </div>
    </div>
    
    <!-- 문제 풀이 모달 -->
    <div class="problem-modal" id="problemModal">
        <button class="btn-close" onclick="closeProblemModal()">×</button>
        <div class="modal-content">
            <div class="problem-section">
                <h2 id="modalProblemTitle"></h2>
                <div id="modalProblemContent"></div>
            </div>
            <div class="code-section">
                <div class="code-header">
                    <h3>코드 작성</h3>
                    <select id="languageSelect">
                        <option value="java">Java</option>
                        <option value="python">Python</option>
                        <option value="javascript">JavaScript</option>
                    </select>
                </div>
                <div class="code-editor">
                    <textarea class="code-textarea" id="codeTextarea" placeholder="여기에 코드를 작성하세요..."></textarea>
                </div>
                <div class="code-actions">
                    <button class="btn-run" onclick="runCode()">실행</button>
                    <button class="btn-submit" onclick="submitCode()">제출</button>
                </div>
            </div>
        </div>
    </div>

    <script src="/js/common/websocket.js"></script>
    <script>
        const problems = {
            array: [
                {
                    id: 1,
                    title: "두 수의 합",
                    difficulty: "easy",
                    description: "배열에서 두 수의 합이 target이 되는 인덱스를 찾으세요.",
                    solvedCount: 1234,
                    totalCount: 2000,
                    points: 10
                },
                {
                    id: 2,
                    title: "배열 회전",
                    difficulty: "medium",
                    description: "배열을 k번 오른쪽으로 회전시키세요.",
                    solvedCount: 890,
                    totalCount: 1500,
                    points: 15
                },
                {
                    id: 3,
                    title: "최대 부분 배열",
                    difficulty: "hard",
                    description: "연속된 부분 배열의 최대 합을 구하세요.",
                    solvedCount: 456,
                    totalCount: 1200,
                    points: 25
                }
            ],
            string: [
                {
                    id: 4,
                    title: "회문 확인",
                    difficulty: "easy",
                    description: "주어진 문자열이 회문인지 확인하세요.",
                    solvedCount: 987,
                    totalCount: 1300,
                    points: 10
                },
                {
                    id: 5,
                    title: "문자열 압축",
                    difficulty: "medium",
                    description: "연속된 문자를 숫자로 압축하세요.",
                    solvedCount: 654,
                    totalCount: 900,
                    points: 15
                }
            ],
            loop: [
                {
                    id: 6,
                    title: "구구단 출력",
                    difficulty: "easy",
                    description: "1부터 9단까지 구구단을 출력하세요.",
                    solvedCount: 1500,
                    totalCount: 1600,
                    points: 5
                },
                {
                    id: 7,
                    title: "별찍기 패턴",
                    difficulty: "medium",
                    description: "주어진 높이만큼 별로 삼각형을 그리세요.",
                    solvedCount: 800,
                    totalCount: 1000,
                    points: 12
                }
            ],
            condition: [
                {
                    id: 8,
                    title: "학점 계산기",
                    difficulty: "easy",
                    description: "점수에 따른 학점을 계산하세요.",
                    solvedCount: 1200,
                    totalCount: 1400,
                    points: 8
                }
            ],
            function: [
                {
                    id: 9,
                    title: "팩토리얼 계산",
                    difficulty: "medium",
                    description: "주어진 수의 팩토리얼을 계산하세요.",
                    solvedCount: 700,
                    totalCount: 900,
                    points: 15
                }
            ],
            recursion: [
                {
                    id: 10,
                    title: "피보나치 수열",
                    difficulty: "medium",
                    description: "재귀를 사용해 피보나치 수열을 구현하세요.",
                    solvedCount: 600,
                    totalCount: 800,
                    points: 18
                }
            ],
            sorting: [
                {
                    id: 11,
                    title: "버블 정렬",
                    difficulty: "medium",
                    description: "버블 정렬 알고리즘을 구현하세요.",
                    solvedCount: 500,
                    totalCount: 700,
                    points: 20
                }
            ],
            search: [
                {
                    id: 12,
                    title: "이진 탐색",
                    difficulty: "hard",
                    description: "정렬된 배열에서 이진 탐색을 구현하세요.",
                    solvedCount: 300,
                    totalCount: 600,
                    points: 25
                }
            ],
            graph: [
                {
                    id: 13,
                    title: "DFS 구현",
                    difficulty: "hard",
                    description: "깊이 우선 탐색을 구현하세요.",
                    solvedCount: 200,
                    totalCount: 500,
                    points: 30
                }
            ],
            dp: [
                {
                    id: 14,
                    title: "동전 교환",
                    difficulty: "hard",
                    description: "최소 동전 개수로 금액을 만드세요.",
                    solvedCount: 150,
                    totalCount: 400,
                    points: 35
                }
            ],
            greedy: [
                {
                    id: 15,
                    title: "회의실 배정",
                    difficulty: "medium",
                    description: "최대 회의 수를 배정하세요.",
                    solvedCount: 250,
                    totalCount: 500,
                    points: 22
                }
            ]
        };
        
        let currentCategory = 'all';
        
        document.addEventListener('DOMContentLoaded', function() {
            setupCategoryTabs();
            loadProblems();
        });
        
        function setupCategoryTabs() {
            const tabs = document.querySelectorAll('.category-tab');
            tabs.forEach(tab => {
                tab.addEventListener('click', function() {
                    tabs.forEach(t => t.classList.remove('active'));
                    this.classList.add('active');
                    currentCategory = this.dataset.category;
                    loadProblems();
                });
            });
        }
        
        function loadProblems() {
            const grid = document.getElementById('problemsGrid');
            let problemsToShow = [];
            
            if (currentCategory === 'all') {
                Object.values(problems).forEach(categoryProblems => {
                    problemsToShow = problemsToShow.concat(categoryProblems);
                });
            } else {
                problemsToShow = problems[currentCategory] || [];
            }
            
            grid.innerHTML = problemsToShow.map(problem => `
                <div class="problem-card">
                    <div class="problem-header">
                        <div>
                            <h3 class="problem-title">${problem.title}</h3>
                        </div>
                        <span class="difficulty-badge difficulty-${problem.difficulty}">
                            ${problem.difficulty === 'easy' ? '쉬움' : problem.difficulty === 'medium' ? '보통' : '어려움'}
                        </span>
                    </div>
                    
                    <p class="problem-description">${problem.description}</p>
                    
                    <div class="problem-meta">
                        <div class="problem-stats">
                            <span>해결: ${problem.solvedCount}/${problem.totalCount}</span>
                            <span>정답률: ${Math.round(problem.solvedCount/problem.totalCount*100)}%</span>
                        </div>
                        <span class="points">+${problem.points}점</span>
                    </div>
                    
                    <div class="problem-actions">
                        <button class="btn-solve" onclick="solveProblem(${problem.id}, '${problem.title}')">문제 풀기</button>
                        <button class="btn-solution" onclick="viewSolution(${problem.id})">💡</button>
                    </div>
                </div>
            `).join('');
        }
        
        function solveProblem(problemId, title) {
            document.getElementById('modalProblemTitle').textContent = title;
            document.getElementById('modalProblemContent').innerHTML = `
                <h3>문제 설명</h3>
                <p>이곳에 상세한 문제 설명이 들어갑니다.</p>
                
                <h3>입력</h3>
                <p>입력 형식에 대한 설명</p>
                
                <h3>출력</h3>
                <p>출력 형식에 대한 설명</p>
                
                <h3>예제</h3>
                <div style="background: #f7fafc; padding: 15px; border-radius: 8px; margin: 10px 0;">
                    <strong>입력:</strong><br>
                    3 5<br>
                    <strong>출력:</strong><br>
                    8
                </div>
            `;
            
            document.getElementById('codeTextarea').value = getStarterCode();
            document.getElementById('problemModal').style.display = 'block';
        }
        
        function getStarterCode() {
            const language = document.getElementById('languageSelect').value;
            
            const templates = {
                java: `public class Solution {
    public static void main(String[] args) {
        // 코드를 작성하세요
    }
}`,
                python: `# 코드를 작성하세요
def solution():
    pass

if __name__ == "__main__":
    solution()`,
                javascript: `// 코드를 작성하세요
function solution() {
    
}

solution();`
            };
            
            return templates[language] || templates.java;
        }
        
        function closeProblemModal() {
            document.getElementById('problemModal').style.display = 'none';
        }
        
        function runCode() {
            alert('코드 실행 기능은 개발 중입니다.');
        }
        
        function submitCode() {
            const code = document.getElementById('codeTextarea').value;
            if (!code.trim()) {
                alert('코드를 작성해주세요.');
                return;
            }
            
            // 간단한 성공 시뮬레이션
            setTimeout(() => {
                alert('정답입니다! +15점이 추가되었습니다.');
                closeProblemModal();
            }, 1000);
        }
        
        function viewSolution(problemId) {
            alert('해답 보기 기능은 개발 중입니다.');
        }
        
        // 언어 변경 시 템플릿 변경
        document.getElementById('languageSelect').addEventListener('change', function() {
            document.getElementById('codeTextarea').value = getStarterCode();
        });
    </script>
</body>
</html>
